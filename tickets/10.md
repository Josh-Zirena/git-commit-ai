## Ticket 10: EC2 Deployment Infrastructure

**Priority:** Medium  
**Estimated Time:** 35 minutes

### Description

Create complete EC2 deployment infrastructure using Terraform and deployment automation scripts for a production-ready environment with authentication and security configured.

### Requirements

- Create Terraform configuration for EC2 instance with proper networking
- Set up security groups with minimal required access (SSH, HTTP/HTTPS)
- Configure Application Load Balancer for high availability
- Create deployment script that handles application updates
- Set up PM2 for process management and auto-restart
- Configure SSL/TLS certificate (Let's Encrypt or ACM)
- Add basic CloudWatch monitoring and alarms
- Configure environment variables for Cognito and security settings

### Files to Create

- `infrastructure/main.tf` - Main Terraform configuration
- `infrastructure/variables.tf` - Terraform variables
- `infrastructure/outputs.tf` - Terraform outputs (IP addresses, DNS names)
- `infrastructure/security-groups.tf` - Security group definitions
- `infrastructure/user-data.sh` - EC2 initialization script
- `scripts/deploy.sh` - Application deployment automation
- `scripts/setup-server.sh` - Initial server setup script
- `ecosystem.config.js` - PM2 process management configuration
- `nginx.conf` - Nginx reverse proxy configuration
- `.env.production` - Production environment variables template

### Infrastructure Specifications

- **EC2 Instance:** t3.micro (or t3.small for production)
- **Operating System:** Ubuntu 22.04 LTS
- **Security Groups:** Allow SSH (22), HTTP (80), HTTPS (443)
- **Load Balancer:** Application Load Balancer with health checks
- **Storage:** 20GB gp3 EBS volume
- **Auto Scaling:** Single instance initially, prepared for scaling

### Deployment Process

1. Terraform provisions infrastructure (including Cognito resources)
2. User data script installs Node.js, PM2, Nginx
3. Deploy script uploads application code and sets environment variables
4. PM2 starts application with zero-downtime restarts
5. Nginx proxies requests to application with SSL termination
6. CloudWatch monitors application health and security metrics

### Testing Requirements

- Test Terraform plan/apply creates resources successfully
- Test EC2 instance is accessible via SSH
- Test application is reachable through load balancer with HTTPS
- Test deployment script successfully updates application
- Test PM2 restarts application on failure
- Test SSL certificate is properly configured
- Test CloudWatch alarms trigger on high CPU/memory
- Test Cognito authentication works in production environment
- Test all security measures are active

### Acceptance Criteria

- `terraform apply` creates complete infrastructure including Cognito
- Application is accessible via HTTPS with valid SSL certificate
- `./scripts/deploy.sh` performs zero-downtime deployment
- PM2 automatically restarts application on crashes
- CloudWatch dashboard shows application and security metrics
- Load balancer health checks pass consistently
- Authentication system works in production environment
- All security measures are properly configured
- Infrastructure costs under $25/month for single instance

---
